# fog-algorithm

### Алгоритм Туман для _относительно безопасного_ публичного хранения сид фраз в открытых местах, таких как: Гугл и прочие диски, почта, распечатки на бумаге и т.д.

> Приведенный ниже способ не является устойчивым алгоритмом шифрования. Это возможность хранить сид-фразу относительно безопасно и не запоминать ее. Используйте на свой страх и риск.

Полученный по алгоритму набор слов можно распечатать на бумаге, закинуть на почту и т.д. 
Вам не потребуется программа для восстановления фразы, если вы понимаете, как работает алгоритм и помните пин-код.
Получить ключ по пин-коду можно даже в табличке excel или вообще на бумажке.


#### Описание работы алгоритма.

Пин-код используемый в этом примере - 123456.

Сид фраза из 12 слов, которую мы собираемся положить в публичном месте после замешивания в туман.
Для наглядности будем использовать цифры вместо слов.
1 2 3 4 5 6 7 8 9 10 11 12

Генерировать первичный туман лучше всего случайно.
Рекомендую использовать библиотеку bip39gen (_Python_).
<https://github.com/massmux/bip39gen>

#### Создаем туман из 100 слов
`
benefit drop gospel infant damage spike ramp spice scene proud sad average fly trim wrong race goose regret reduce clerk happy gaze neck fragile wave execute dry file later auction such connect genius panther awesome screen glide during repair carry people stereo caught elder build near candy barrel boy ready version salad regret rival laugh tornado autumn tilt fit river purity drum churn can shrug segment sponsor away tag honey follow wagon problem fragile quantum input leaf wrong chimney panel horse force enlist dawn fox helmet equip improve december polar exhaust guide soft fiction fiction coast expose search manual toilet
`

##### Первичный ключ
Образуется склеиванием пин-кода с самим собой до получения длины равной кол-ву слов в сид фразе минус 1. Ниже будет ясно почему меньше на единицу.
В этом пример длина пин-кода 6 символов. Поэтому мы _добиваем_ еще 5 символов из начала пин-кода к его концу.
Таким образом первичный ключ тумана 12345612345, всего 11 символов.

##### Генерируем ключ тумана

Первичный ключ выглядит так. __К__ это контрольный символ, его расчитаем позже.
| 0  | 1  |  2 | 3  | 4  |  5 | 6  | 7  | 8  | 9  | 10  | К |
|---|---|---|---|---|---|---|---|---|---|---|---|
|  1 | 2  | 3  | 4  | 5  | 6  | 1  | 2  | 3  | 4  | 5  |  |

Теперь, каждый цифру первичного ключа имеющую четный индекс складываем с индексом.
Каждую цифру первичного ключа имеющую нечетный индекс возводим в квадрат.
Если полученный результат уже присутствует в предыдущих значениях, умножаем его на 2 и добавляем. 
Если это уникальное значение, то добавляем как есть.

Получаем такой вид ключа тумана.
| 0  | 1  |  2 | 3  | 4  |  5 | 6  | 7  | 8  | 9  | 10  | К |
|---|---|---|---|---|---|---|---|---|---|---|---|
|  1 | 2  | 3  | 4  | 5  | 6  | 1  | 2  | 3  | 4  | 5  |  |
|  1 | 4  |5  | 16  | 9  | 36  | 7  | 8  | 11  | 32  |15  |  |

Контрольный символ вычисляется как остаток от деления суммы всех цифр ключа на кол-во цифр в ключе.
В нашем случае 1+4+5+16+9+36+7+8+11+32+15 = 144. Остаток деления 144 % 11 = 1

Мы получили ключ тумана.
| 0  | 1  |  2 | 3  | 4  |  5 | 6  | 7  | 8  | 9  | 10  | К |
|---|---|---|---|---|---|---|---|---|---|---|---|
|  1 | 2  | 3  | 4  | 5  | 6  | 1  | 2  | 3  | 4  | 5  |  |
|  1 | 4  |5  | 16  | 9  | 36  | 7  | 8  | 11  | 32  |15  | 1 |


#### Создание публичного тумана
_Для генерации тумана лучше использовать программу, ибо делать это руками будет достаточно неудобно)_
После генерации первичного тумана из случайных слов (выше), записываем нашу сид фразу в туман таким образом:
1. Преобразуем первичный туман в список (_для Pyhon_)
2. Берем последний символ ключа тумана (_обратный цикл_). Его индекс 11, а значение 1.
3. Берем из сид фразы слово стоящее под номер 11 и добавляем (_insert_) его в список с индексом 1.
4. Туман увеличивается на одно слово, а старые индексы смещаются.
5. Повторяем с предыдущим символом из ключа (10,15) и увеличенным списком.
6. Таким образом, полученный список увеличится на 12 слов.
7. Преобразуем список в строку и полученный набор слов можно распечать, сохранить на компьютере и т.д.



#### Итоговый туман, после полного прохода
`
benefit 1 12 drop gospel 2 infant 3 damage spike 7 ramp 5 8 spice scene proud 9 sad 4 average fly trim 11 wrong race goose regret reduce clerk happy gaze neck fragile wave execute dry file later auction 10 6 such connect genius panther awesome screen glide during repair carry people stereo caught elder build near candy barrel boy ready version salad regret rival laugh tornado autumn tilt fit river purity drum churn can shrug segment sponsor away tag honey follow wagon problem fragile quantum input leaf wrong chimney panel horse force enlist dawn fox helmet equip improve december polar exhaust guide soft fiction fiction coast expose search manual toilet
`

#### Восстановление сид фразы из тумана достаточно просто выполнить без компьютера
Теперь цикл уже прямой.
1. Создаем пустой список для записи слов из тумана.
2. Преобразуем строку тумана в список (_для Python_)
3. Создаем снова ключ тумана по пин-коду
4. Берем нулевой индекс ключа. Это 1.
5. Добавляем слово из туманного списка с индексом 1 в список слов. Это первое слово из сид фразы.
6. Из туманного списка удаляется элемент с индексом 1. Туман слов укорачивается, индексы смещаются.
7. Шаги 3-5 повторяются до перебора всей длины ключа.

